!function(t,e){t.FreeScroll=t.FS=e(t)}(this,function(){"use strict";function t(r){if(!u(this))return new t(r);if(!r)return this;if(u(r))return r;if(this.options=t.updateOptions(s,r),this.options.selector){var i=n.apply(this,o.call(e.querySelectorAll(this.options.selector))),a=this;return p=function(){if(t.noMore(this,a.options.distance)){var e;null===a.options.requestData.urlFormat||a.finished||(e=t.xhr(a)),t.fire(c,a,this,e)}},a.addEvent("scroll",p),i}}var e=window.document,n=[].push,o=[].slice,r=[].splice,i={},s={selector:null,distance:100,requestData:{urlFormat:null,pageNumber:1,pageSize:10},templateUrl:null},c="toInfinity",u=function(e){return e instanceof t},a=function(t,e){for(var n=0;n<t.length;n++)e(n,t[n])},l=function(t){return{}.toString.call(t).match(/\s([a-zA-Z]+)/)[1].toLowerCase()},p=function(){};return t.prototype={options:{},finished:!1,finish:function(t){this.removeEvent("scroll",p),this.off(c),this.finished=!0,console.log(t)},on:function(e,n){i[t.genEventId(this.options.selector,e)]?i[t.genEventId(this.options.selector,e)].push(n):i[t.genEventId(this.options.selector,e)]=[n]},off:function(e){i[t.genEventId(this.options.selector,e)]&&delete i[t.genEventId(this.options.selector,e)]},addEvent:function(t,e){this.each(function(n,o){o.attachEvent?(o["e"+t+e]=e,o[t+e]=function(){o["e"+t+e](window.event)},o.attachEvent("on"+t,o[t+e])):o.addEventListener(t,e,!1)})},removeEvent:function(t,e){this.each(function(n,o){o.detachEvent?(o.detachEvent("on"+t,o[t+e]),o[t+e]=null):o.removeEventListener(t,e,!1)})},each:function(t){var e=this;a(e,t)}},t.fire=function(e,n){var o=[].slice.call(arguments,2);i[t.genEventId(n.options.selector,e)]||(i[t.genEventId(n.options.selector,e)]=[]);for(var r=0,s=i[t.genEventId(n.options.selector,e)].length;s>r;r++)i[t.genEventId(n.options.selector,e)][r].apply(null,o)},t.noMore=function(t,e){return t.scrollHeight-(t.scrollTop+e)<=t.clientHeight},t.genEventId=function(t,e){return t+"_"+e},t.updateOptions=function(e,n){var o=JSON.parse(JSON.stringify(e));if("object"==typeof n)for(var r in e)o[r]=e.hasOwnProperty(r)&&"object"!==l(e[r])&&e[r]!==n[r]?n[r]||e[r]:e.hasOwnProperty(r)&&"object"==typeof e[r]?t.updateOptions(e[r],n[r]):e[r];else"string"==typeof n&&(o=e,o.selector=n);return o},t.fn=t.prototype,t.prototype.splice=r,t}),function(t,e){t.FreeScroll.xhr=t.FS.xhr=e(t)}(this,function(t){"use strict";var e=function(t){var e;try{e=JSON.parse(t.responseText)}catch(n){e=t.responseText}return[e,t]};return function(n){var o={success:function(){},error:function(){}},r=t.XMLHttpRequest||ActiveXObject,i=new r("MSXML2.XMLHTTP.3.0"),s=n.options.requestData;return i.open("GET",s.urlFormat.format(s.pageNumber,s.pageSize)),i.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(s.pageNumber+=1,o.success.apply(o,e(i))):(o.error.apply(o,e(i)),n.finish()))},i.send(),{success:function(t){return o.success=t,o},error:function(t){return o.error=t,o}}}}),String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return"undefined"!=typeof t[n]?t[n]:e})});